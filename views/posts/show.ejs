<%- include("../partials/header") %>
<body>
    <div id="post-index-page">
        <a href="/posts/#nav">Back to all Posts</a>
        <div id="post-container">
            <div>
                <h1><%= post.title %></h1>
                <small>Posted By: <a href="/users/<%= post.creator.userID %>"><%= post.creator.displayName %></a></small>
            </div>
            <div>
                <p><%= post.description %></p>
                <p><pre><%= post.body %></pre></p>
            </div>
        </div>
        <div>
            <h1>Comments</h1>
            <form action="/posts/<%= post._id %>/comment" method="POST">
                <input type="text" name="comment" autocomplete="off">
                <button type="submit">Comment</button>
            </form>
            <% for(let i = 0; i < comments.length; i++) { %>
                <p><a href="/users/<%= comments[i].creator.userID %>"><%= comments[i].creator.displayName %></a><br/> <%= comments[i].comment %></p>
                <form action="/posts/<%= post._id %>/<%= comments[i]._id %>/like" method="POST">
                    <button id="like-button" type="submit">
                        <% if(comments[i].likedBy.indexOf(currentUser._id) === -1) { %>
                            <img src="/css/images/thumbs-up.png">
                        <% } else { %>
                            <img src="/css/images/thumbs-up-filled.png">
                        <% } %>
                    </button>
                </form>
                <% if(post.creator.username === currentUser.username || currentUser.username === comments[i].creator.username) { %>
                    <form action="/posts/<%= post._id %>/<%= comments[i]._id %>?_method=DELETE" method="POST">
                        <button type="submit">delete comment</button>
                    </form>
                <% } %><br/>
            <% } %>
        </div>
        <div>
            <% if(post.creator.username === currentUser.username) { %>
                <form action="/posts/<%= post._id %>/?_method=DELETE" method="POST">
                    <button type="submit">Delete Post</button>
                </form>
            <% } %>
        </div>
    </div>
</body>
</html>